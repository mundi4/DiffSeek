# DiffSeek 

## 개요
- **정말 센스만점 이름.** 중국산 DeepSeek 아님. diff를 seek함.
- 한글자 한글자 눈으로 비교하는건 죽어도 못하겠고 죽어도 하기 싫어서... 사람이 할 짓은 아닌 것 같아서...
- 공백 무시. 공백을 완전히 무시하는건 완전히 의도된 것임. 업무매뉴얼의 줄바꿈 위치는 절대로 문장의 끝 혹은 단락의 끝과 일치하지 않음! 그저 줄이 길어졌다 싶으면 엔터 한방 누르고 스페이스바 열심히 눌러서 들여쓰기 맞추는게 업무매뉴얼임. 공백을 전혀 무시하지 않거나 정규화(여러개의 연속된 공백을 하나로 인식)해서 비교하는 코드를 짜는게 훨씬 쉽다.
- [GitHub](https://github.com/mundi4/DiffSeek)

## 구현 의도? 참고사항?
- 양쪽에 텍스트 붙여넣고 실행버튼 딱~ 누르면 diff들이 표시되게....
    *그딴 짓을 왜???? 버튼을 뭐하러 눌러? 그냥 척하면 딱.*
    **diff는 텍스트 변경시 실시간으로, 입력한 텍스트 바로 그 자리에 보여줘야 함!!** 매번 귀찮게 버튼 누르는 짓은 하고 싶지 않다. 결과view를 완전히 새로 만드는 것이 훨씬 쉽지만.. 너무 쉬울까봐 안한거임.
- HTML 없이 순수 텍스트만을 다루는 것으로 시작했지만 결국 HTML 단계까지 와버렸음. 
- 실시간으로 업데이트가 일어나는 도중에도 편집을 방해하면 안됨. 미세한 딜레이라든지 의도하지 않은 커서위치 변경, 한글입력상태 복원 등등(한글입력상태 복원 방법은 없다 보면 됨. 우회하는 방법은 업데이트를 안하는것, 최소한 현재 커서가 위치한 노드에 대해서는 그냥 업데이트를 안하고 미루는 방법이 거의 유일한 듯?).
- 위와 같은 이유로 에디터 내부의 DOM 변경을 최소로 하면서 각 노드의 경계를 지멋대로 넘나드는 diff 영역을 하이라이트 하기 위해 canvas 사용.
- 편집기(그냥 단순 `<div contenteditable>`임)의 기본적인 기능(복붙,undo/redo,...)들은 되도록 브라우저에게 넘길 것. 이런 기능들은 숨쉬기와 같아서 예상대로 작동 안하는 순간 짜증 솟구침. 또한 나처럼 깐깐한 사람에게 어색함이 안느껴질만큼 제대로 구현하기는 쉽지 않음(커서위치, 텍스트선택범위, 스크롤 위치, 얼마나 많은 편집을 얼마의 딜레이 간격으로 하나의 히스토리 엔트리로 묶을 것인가, 그리고 양쪽 편집기를 왔다갔다 했을 때 등 생각보다 신경쓸 게 많음. 단순히 text만 보관하는 것으로는 어림 없음).
- 처음엔 그랬지만... HTML을 HTML으로 보여주기 시작하면서부터 붙여넣기는 반드시 개입이 필요해짐. `document.execCommand("insertHTML",...)`를 쓰면 undo/redo 문제 없이 작동하지만 이 함수는 정말 끔찍하리만큼 느림. 레거시 함수라서 한 20년 간 개선 없이 버려둔 듯. 어쩔 수 없이 큰 문서를 붙여넣을 땐 다른 방법을 써야했고 그런 경우 undo로 붙여넣기 이전 상태로 돌아가는 건 불가능함.
- diff 하이라이트 색들은 정말 **세심하게 고른** 것들임. 절대 불만을 가져서는 안됨. 빨간색 계통은 배경과 확실히 대비되지 않을 수 있기 때문에 의도적으로 제외함..
- 큰 워드문서에서 복붙을 할 때에 복사가 바로 되지 않는 문제가 있는데 절대적으로 MS워드의 문제임. 될때까지 붙여넣기 하면 언젠가는 된다(기다리는 동안 워드는 먹통됨).
    - 처음엔 복사 이전 클립보드에 들어있던 내용이 붙여넣기 됨
    - 재시도(`ctrl-v`) 하다보면 빈 텍스트가 붙여넣기 됨
    - 계속... 재시도(`ctrl-v`)하다보면 결국 성공함.
- 엣지(혹은 크롬) 전용. 인간적으로 2025년에 ie를 왜 써야하지(회사 기본 브라우저가 ie).

## 정렬 모드
- 양쪽 에디터에서 서로 대비되는 줄들의 위치를 같게 맞춰주는 기능. `F2`로 토글.
- 양쪽 스크롤 동기화됨.
- readonly 모드임.

## 수직/수평 배열
- 전혀 필요하지 않은 기능. `F10`

## 브라우저, 메모장만 사용가능
- 결국 브라우저 안에서 돌아가는 자바스크립트가 유일한 옵션인데 사실 브라우저에 익숙하지 않은 사람은 없고 기본적인 동작들은 모두 매끄럽게 구현이 다 되어있으니 어찌보면 최고/최선의 선택인듯 함.
- 당연히 로컬서버 불가능이고 파일경로(`file://...`)로 열어야함. 제약이 좀 있음.
